(function(){const u=`
<svg id="ukeChordSvg" width="90" height="112" viewBox="0 0 90 112" style="font-family: sans-serif; font-size: 11px;" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <title id="title">uke-chord</title>
  <style id="style"></style>
  <text id="chordName" x="50%" y="16"  text-anchor="middle" style="font-size: 16px;"></text>
  <defs>
    <circle id="bubble" r="6" transform="translate(1,11)"/>
    <path id="ex" d="M0,0L8,8m0,-8L0,8" stroke-width="1.1" transform="translate(-3,-11)"/>
    <circle id="openString" r="4" fill="none" stroke-width="1" transform="translate(1,-7)"/>
    <rect id="diamond" width="14" height="14" transform="translate(1,2),rotate(45)"></rect>
  </defs>
  <g id="tab">
    <text id="position" x="-6" y="15" text-anchor="end"></text>
    <g id="frets"></g>
    <g id="strings"></g>
  </g>
</svg>`;function g(o,e,t){t.setAttribute("transform","translate("+o+","+e+")")}function l(o,e){const t=document.createElementNS("http://www.w3.org/2000/svg",o);return e&&Object.keys(e).forEach(s=>{t.setAttribute(s,e[s]+"")}),t}function d(o,e){const t=l("use",e);return t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","#"+o),t}function c(o,e,t){if(!o||typeof o.getPropertyValue!="function")return t;const s=o.getPropertyValue(e);return s&&s.trim()||t}class p extends HTMLElement{connectedCallback(){for(let i=0;i<this.attributes.length;i++)this[this.attributes[i].name]=this.attributes[i].value;this.attachShadow({mode:"open"});const e=document.createElement("template");e.innerHTML=u;const t=e.content.querySelectorAll("*[id]");if(this.$={},t.forEach(i=>{this.$[i.id]=i}),this.frets)this.frets=this.frets.split("").slice(0,10);else throw Error("frets attribute is required");this.fingers=this.fingers?this.fingers.split(""):[],this.sub=this.parseSub(this.sub),this.size=this.parseSize(this.size),this.r=this.r?this.r.split(""):[];const s=this.barre?this.barre.split("").slice(0,this.frets.length):[];this.barreSegments=this.parseBarre(s);const n=parseInt(this.position,10);this.position=Number.isNaN(n)?null:n,this.name=this.name&&this.name.length>0?this.name:null,this.fretCount=this.parseLength(this.length);const h=getComputedStyle(this);if(this.fillColor=c(h,"--uke-fill","black"),this.fingerTextColor=c(h,"--uke-fingertext","white"),this.textColor=c(h,"--uke-text","black"),this.$.style.textContent=`
      rect { fill: ${this.fillColor}; }
      #openString { stroke: ${this.fillColor}; }
      #ex { stroke: ${this.fillColor}; }
      #bubble { fill: ${this.fillColor}; }
      text { fill: ${this.textColor}; }
      #strings text { fill: ${this.fingerTextColor}; }
      `,this.tabWidth=(this.frets.length-1)*20+2,this.viewBoxWidth=this.tabWidth+30+(this.position?6:0),this.tabHeight=this.fretCount*20,this.viewBoxHeight=this.tabHeight+25+(this.name?25:0),this.tabX=(this.viewBoxWidth-this.tabWidth)/2,this.tabY=12+(this.name?20:0),this.reset(),this.render(),this.hasAttribute("img")){const i=document.createElement("img");i.alt=(this.name?`${this.name} `:"")+"chord",i.title=i.alt,i.src=`data:image/svg+xml;utf8,${encodeURIComponent(e.innerHTML.replace(/\s*(\r\n|\n|\r)\s*/gm,""))}`,this.shadowRoot.appendChild(i)}else this.shadowRoot.appendChild(e.content)}reset(){this.$.frets.replaceChildren(),this.$.strings.replaceChildren();let e=this.$.strings.nextSibling;for(;e;){const t=e.nextSibling;e.remove(),e=t}this.$.position.textContent="",this.$.chordName.textContent=""}render(){this.showPosition(),this.showName();const e=this.barreSegments||[];for(let t=0;t<this.fretCount+1;t++){const s=l("rect",{x:0,y:t*20,width:this.tabWidth,height:2});this.$.frets.appendChild(s)}this.frets.forEach((t,s)=>{const n=s*20,h=l("rect",{x:n,y:0,width:2,height:this.tabHeight});if(this.$.strings.appendChild(h),this.r.includes(this.frets.length-s+"")){const i=(parseInt(t)-1)*20,r=d("diamond",{x:n,y:i});this.$.strings.appendChild(r)}if(t==="0"){const i=d("openString",{x:n});this.$.strings.appendChild(i)}else if(t==="x"||t==="X"){const i=d("ex",{x:n});this.$.strings.appendChild(i)}else{const i=parseInt(t,10);if(!(i>0))return;const r=(i-1)*20,a=d("bubble",{x:n,y:r});if(this.$.strings.appendChild(a),this.fingers[s]){const f=l("text",{x:n+1,y:r+15,"text-anchor":"middle"});f.innerHTML=this.fingers[s]!=="0"?this.fingers[s]:"",this.$.strings.appendChild(f)}}if(this.sub[s]){const i=this.tabHeight+13,r=l("text",{x:n,y:i,"text-anchor":"middle"});r.innerHTML=this.sub[s]!=="_"?this.sub[s]:"",this.$.tab.appendChild(r)}}),e.forEach(t=>{const s=t.start*20-5,n=(t.end-t.start)*20+12,h=(t.fret-1)*20+5,i=l("rect",{x:s,y:h,width:n,height:12,rx:6,ry:6}),r=this.$.strings.firstChild;r?this.$.strings.insertBefore(i,r):this.$.strings.appendChild(i)}),g(this.tabX,this.tabY,this.$.tab),this.$.ukeChordSvg.setAttribute("width",this.viewBoxWidth*this.size),this.$.ukeChordSvg.setAttribute("height",this.viewBoxHeight*this.size),this.$.ukeChordSvg.setAttribute("viewBox",`0 0 ${this.viewBoxWidth} ${this.viewBoxHeight}`)}showPosition(){const e=this.position;if(e===0){const t=l("rect",{x:0,y:-1,width:this.tabWidth,height:4});this.$.frets.appendChild(t)}else e>0&&e<100&&(this.$.position.innerHTML=e)}showName(){this.name&&(this.$.chordName.innerHTML=this.name),this.$.title.innerHTML=this.name||"Tab"}parseSub(e){let t;return e?(e.indexOf(",")>0?t=e.split(","):t=e.split(""),t||[]):[]}parseSize(e){let t=1;return e==="L"||e==="l"?t=1.8:parseFloat(e)>0&&(t=parseFloat(e)),t}parseLength(e){let t=parseInt(e,10);return(!t||t>20)&&(t=4),t}parseBarre(e){if(!e||!e.length)return[];const t=[];let s=null,n=null;const h=i=>{s!==null&&i-s>=2&&n&&t.push({start:s,end:i-1,fret:n}),s=null,n=null};return e.forEach((i,r)=>{const a=parseInt(i,10);if(!a||a<1){h(r);return}if(s===null){s=r,n=a;return}a!==n&&(h(r),s=r,n=a)}),h(e.length),t}}customElements.define("uke-chord",p)})();
